import streamlit as st
import pandas as pd
from decimal import Decimal, ROUND_HALF_UP

st.markdown(
    """
    <div style="text-align: center;">
        <p style="color: #003366; font-weight: bold; font-size: 25px; margin: 0;">
            BỘ GIÁO DỤC VÀ ĐÀO TẠO
        </p>
        <p style="color: #003366; font-weight: bold; font-size: 40px; margin: 0;">
            TRƯỜNG ĐẠI HỌC MỞ THÀNH PHỐ HỒ CHÍ MINH
        </p>
    </div>
    """,
    unsafe_allow_html=True
)

# Tiêu đề chính
st.markdown(
    "<h1 style='text-align: center; color: #003366;'>TÍNH ĐIỂM XÉT TUYỂN</h1>",
    unsafe_allow_html=True
)


st.markdown("""
    <style>
    /* Màu nền và bo góc cho tab */
    .stTabs [role="tab"] {
        padding: 10px 20px;
        border-radius: 8px 8px 0 0;
        font-weight: 900; /* siêu đậm */
        font-size: 16px;  /* to hơn một chút */
        color: black;     /* màu chữ */
    }
    /* Tab 1 */
    .stTabs [role="tab"]:nth-child(1) {
        background-color: #ffcccc;
    }
    /* Tab 2 */
    .stTabs [role="tab"]:nth-child(2) {
        background-color: #ccffcc;
    }
    /* Tab 3 */
    .stTabs [role="tab"]:nth-child(3) {
        background-color: #ccccff;
    }
    /* Khi tab được chọn thì viền nổi bật */
    .stTabs [role="tab"][aria-selected="true"] {
        border: 2px solid #000;
    }
    </style>
""", unsafe_allow_html=True)


st.markdown("""
    <style>
    /* Tăng cỡ chữ toàn bộ giao diện */
    html, body, [class*="css"]  {
        font-size: 20px !important;
    }

    /* Label của các input */
    label {
        font-size: 20px !important;
        font-weight: bold;
    }

    /* Ô nhập số */
    .stNumberInput input {
        font-size: 20px !important;
        font-weight: bold;
    }
    </style>
""", unsafe_allow_html=True)





tab1, tab2, tab3 = st.tabs(["TN THPT", "V-SAT", "ĐGNL TP. Hồ Chí Minh"])

with tab1:
    cau_hinh_xt = {
        "7220201": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7220204": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220209": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220210": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7310101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7310301": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7310401": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7310620": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },    
        "7340101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340115": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340120": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340204": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340205": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340301": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D84": {"TO": 1, "N1": 1, "GDCD": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X25": {"TO": 1, "N1": 1, "KTPL": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1}, 
        },
        "7340302": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D84": {"TO": 1, "N1": 1, "GDCD": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X25": {"TO": 1, "N1": 1, "KTPL": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1}, 
        },
        "7340403": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7340404": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340405": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7380101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
        },
        "7380107": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
        },
        "7420201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X57": {"TO": 1, "TI": 1, "CNNN": 1},
        },
        "7460108": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480103": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480107": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7510102": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7510605": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D10": {"TO": 1, "DI": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X22": {"TO": 1, "DI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7540101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
        },
        "7580302": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7760101": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7810101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "D10": {"TO": 1, "DI": 1, "N1": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
        },
        "7220201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7220204C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220209C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7310101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
        },
        "7340101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7340201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "D10": {"TO": 1, "DI": 1, "N1": 2},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7340301C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7340302C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7380107C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7420201C": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X28": {"TO": 1, "N1": 1, "CNNN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
        },
        "7480101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7480201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7510102C": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7220201FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
        },
        "7340101FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        }, 
        "7340101SQ": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340101SW": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340201FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        }
    }

    diem_san_mac_dinh = {
        "7340101": 16.0, "7340101C": 16.0, "7340115": 16.0, "7340120": 16.0,
        "7340201": 16.0, "7340201C": 15.0, "7340204": 15.0, "7340205": 16.0,
        "7340301": 16.0, "7340301C": 15.0, "7340302": 16.0, "7340302C": 15.0,
        "7340403": 15.0, "7340404": 16.0, "7340405": 16.0, "7380101": 16.0,
        "7380107": 16.0, "7380107C": 16.0, "7420201": 15.0, "7420201C": 15.0,
        "7460108": 16.0, "7480101": 16.0, "7480101C": 16.0, "7480107": 16.0,
        "7480103": 16.0, "7480201": 16.0, "7480201C": 16.0, "7510102": 15.0,
        "7510102C": 15.0, "7510605": 16.0, "7540101": 15.0, "7580302": 15.0,
        "7220201": 16.0, "7220201C": 16.0, "7220204": 16.0, "7220204C": 16.0,
        "7220209": 16.0, "7220209C": 16.0, "7220210": 16.0, "7310101": 16.0,
        "7310101C": 15.0, "7310301": 15.0, "7310401": 16.0, "7310620": 15.0,
        "7760101": 15.0, "7810101": 16.0, "7220201FL": 15.0, "7340101FL": 15.0,
        "7340101SQ": 15.0, "7340101SW": 15.0, "7340201FL": 15.0,
    }
    def lam_tron_tuy_chinh(value):
        return float(
            Decimal(value)
            .quantize(Decimal("0.001"), rounding=ROUND_HALF_UP)
            .quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)
        )

    def tinh_diem_to_hop(diem_mon, ma_nganh, tohop):
        if ma_nganh not in cau_hinh_xt or tohop not in cau_hinh_xt[ma_nganh]:
            return None
        mon_he_so = cau_hinh_xt[ma_nganh][tohop]
        tong_diem = 0
        tong_he_so = 0
        for mon, he_so in mon_he_so.items():
            diem = diem_mon.get(mon)
            if diem is None or diem == 0:
                return None  # Môn liệt hoặc chưa nhập
            tong_diem += diem * he_so
            tong_he_so += he_so
        return tong_diem * 3 / tong_he_so  # Quy đổi về thang 30 toàn hệ số 1

    st.set_page_config(page_title="Phần mềm quy đổi điểm V-SAT", layout="wide")

    st.markdown(
    "<h1 style='text-align: center; color: #003366;'>PHƯƠNG THỨC XÉT TUYỂN KẾT QUẢ KỲ THI TỐT NGHIỆP THPT</h1>",
    unsafe_allow_html=True
    )

    st.markdown(
    """
    <div style="
        background-color:#ffcccc;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: black;
    ">
        NHẬP TẤT CẢ CÁC ĐIỂM MÔN THI
    </div>
    """,
    unsafe_allow_html=True
)

    mon_hoc = ["TO","LI","HO","SI","SU","DI","VA","GDCD","KTPL","CNNN","CNCN","TI","N1","N2","N3","N4","N5","N6","N7"]

    mon_fullname = {
        "TO": "Toán",
        "LI": "Vật lý",
        "HO": "Hóa học",
        "SI": "Sinh học",
        "SU": "Lịch sử",
        "DI": "Địa lý",
        "VA": "Ngữ văn",
        "GDCD": "Giáo dục công dân",
        "KTPL": "Giáo dục Kinh tế & Pháp luật",
        "CNNN": "Công nghệ Nông nghiệp",
        "CNCN": "Công nghệ Công nghiệp",
        "TI": "Tin học",
        "N1": "Tiếng Anh",
        "N2": "Tiếng Nga",
        "N3": "Tiếng Pháp",
        "N4": "Tiếng Trung Quốc",
        "N5": "Tiếng Đức",
        "N6": "Tiếng Nhật",
        "N7": "Tiếng Hàn",
    }

    diem_mon = {}
    for i in range(0, len(mon_hoc), 5):
        cols = st.columns(5)
        for j, mon in enumerate(mon_hoc[i:i+5]):
            with cols[j]:
                diem_mon[mon] = st.number_input(mon_fullname[mon], 0.0, 10.0, step=0.1)

    st.markdown(
    """
    <div style="
        background-color:#ccffcc;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: black;
    ">
        ĐỐI TƯỢNG VÀ KHU VỰC ƯU TIÊN
    </div>
    """,
    unsafe_allow_html=True
)


    doi_tuong = st.selectbox("Chọn đối tượng ưu tiên", ["Không", "ĐT01", "ĐT02", "ĐT03", "ĐT04", "ĐT05", "ĐT06", "ĐT07"])
    diem_uu_tien_dt = 2 if doi_tuong in ["ĐT01", "ĐT02", "ĐT03", "ĐT04"] else (1 if doi_tuong in ["ĐT05", "ĐT06", "ĐT07"] else 0)

    khu_vuc = st.selectbox("Chọn khu vực ưu tiên", ["KV1", "KV2NT", "KV2", "KV3"])
    diem_uu_tien_kv = {"KV1": 0.75, "KV2NT": 0.5, "KV2": 0.25, "KV3": 0}[khu_vuc]

    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        CHỨNG CHỈ QUỐC TẾ
    </div>
    """,
    unsafe_allow_html=True
)



    ielts = st.number_input("IELTS Academic", min_value=0.0, max_value=9.0, step=0.5, format="%.1f", value=0.0)
    toefl_ibt = st.number_input("TOEFL iBT", min_value=0, max_value=150, step=1, value=0)
    toefl_itp = st.number_input("TOEFL ITP", min_value=0, max_value=100, step=1, value=0)
    hsk3 = st.number_input("HSK3", min_value=0, max_value=300, step=1, value=0)
    hsk4 = st.number_input("HSK4", min_value=0, max_value=300, step=1, value=0)
    hsk5 = st.number_input("HSK5", min_value=0, max_value=300, step=1, value=0)
    hsk6 = st.number_input("HSK6", min_value=0, max_value=300, step=1, value=0)
    jlpt_n1 = st.number_input("JLPT_N1", min_value=0, max_value=300, step=1, value=0)
    jlpt_n2 = st.number_input("JLPT_N2", min_value=0, max_value=300, step=1, value=0)
    jlpt_n3 = st.number_input("JLPT_N3", min_value=0, max_value=300, step=1, value=0)
    topikii_3 = st.number_input("TOPIK II_N3", min_value=0, max_value=300, step=1, value=0)
    topikii_4 = st.number_input("TOPIK II_N4", min_value=0, max_value=300, step=1, value=0)
    topikii_5 = st.number_input("TOPIK II_N5", min_value=0, max_value=300, step=1, value=0)
    topikii_6 = st.number_input("TOPIK II_N6", min_value=0, max_value=300, step=1, value=0)

    n1_quydoi = None
    n4_quydoi = None
    diem_cong_ccnn = 0.0

    def tinh_diem_cong_ccnn(loai_ccnn, diem):
        if loai_ccnn == "IELTS Academic":
            if diem >= 8.5:
                return 2.0
            elif diem >= 8.0:
                return 1.5
            elif 7.0 <= diem <= 7.5:
                return 1.0
            elif 6.0 <= diem <= 6.5:
                return 0.5
        elif loai_ccnn == "TOEFL iBT":
            if diem >= 79:
                return 2.0
            elif 60 <= diem <= 78:
                return 1.5
            elif 46 <= diem <= 59:
                return 1.0
        elif loai_ccnn == "TOEFL ITP":
            if diem >= 547:
                return 2.0
            elif 520 <= diem <= 546:
                return 1.5
            elif 513 <= diem <= 517:
                return 1.0
            elif 490 <= diem <= 510:
                return 0.5
        elif loai_ccnn == "HSK3":
            if diem >= 180:
                return 0.5
        elif loai_ccnn == "HSK4":
            if diem >= 180:
                return 1
        elif loai_ccnn == "HSK5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "HSK6":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N1":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N2":
            if diem >= 150:
                return 1.5
        elif loai_ccnn == "JLPT_N2":
            if diem >= 90:
                return 1
        elif loai_ccnn == "JLPT_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N4":
            if diem >= 1:
                return 1
        elif loai_ccnn == "TOPIK II_N5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "TOPIK II_N6":
            if diem >= 1:
                return 2
        return 0.0


    diem_cong_ccnn = max(
        tinh_diem_cong_ccnn("IELTS Academic", ielts),
        tinh_diem_cong_ccnn("TOEFL iBT", toefl_ibt),
        tinh_diem_cong_ccnn("TOEFL ITP", toefl_itp),
        tinh_diem_cong_ccnn("HSK3", hsk3),
        tinh_diem_cong_ccnn("HSK4", hsk4),
        tinh_diem_cong_ccnn("HSK5", hsk5),
        tinh_diem_cong_ccnn("HSK6", hsk6),
        tinh_diem_cong_ccnn("JLPT_N1", jlpt_n1),
        tinh_diem_cong_ccnn("JLPT_N2", jlpt_n2),
        tinh_diem_cong_ccnn("JLPT_N3", jlpt_n3),
        tinh_diem_cong_ccnn("TOPIK II_N3", topikii_3),
        tinh_diem_cong_ccnn("TOPIK II_N4", topikii_4),
        tinh_diem_cong_ccnn("TOPIK II_N5", topikii_5),
        tinh_diem_cong_ccnn("TOPIK II_N6", topikii_6),
    )



    def quy_doi_n1_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "IELTS Academic":
            if diem >= 6.5:
                return 10
            elif diem == 6.0:
                return 9
            elif diem == 5.5:
                return 8
            elif diem == 5.0:
                return 7
        elif loai_ccnn == "TOEFL iBT":
            if diem >= 79:
                return 10
            elif 60 <= diem <= 78:
                return 9
            elif 46 <= diem <= 59:
                return 8
            elif 35 <= diem <= 45:
                return 7
        elif loai_ccnn == "TOEFL ITP":
            if diem >= 547:
                return 10
            elif 520 <= diem <= 543:
                return 9
            elif 513 <= diem <= 517:
                return 8
            elif 490 <= diem <= 510:
                return 7
        return None

    def quy_doi_n4_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "HSK3":
            if 261 <= diem <= 300:
                return 9
            elif 221 <= diem <= 260:
                return 8
            elif 180 <= diem <= 220:
                return 7
        elif loai_ccnn == "HSK4":
            if diem >= 180:
                return 10
        elif loai_ccnn == "HSK5":
            if diem >= 1:
                return 10
        elif loai_ccnn == "HSK6":
            if diem >= 1:
                return 10
        return None

    def quy_doi_n6_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "JLPT_N3":
            if diem >= 161:
                return 10
            elif 141 <= diem <= 160:
                return 9
            elif 121 <= diem <= 140:
                return 8
            elif 95 <= diem <= 120:
                return 7   
        elif loai_ccnn == "JLPT_N2":
            if diem >= 1:
                return 10
        return None

    def quy_doi_n7_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "TOPIK II_N3":
            if 230 <= diem <= 300:
                return 10
            elif 190 <= diem <= 229:
                return 9
            elif 150 <= diem <= 189:
                return 8
            elif 120 <= diem <= 149:
                return 7   
        return None

    n1_quydoi_list = [
        quy_doi_n1_tu_ccnn("IELTS Academic", ielts),
        quy_doi_n1_tu_ccnn("TOEFL iBT", toefl_ibt),
        quy_doi_n1_tu_ccnn("TOEFL ITP", toefl_itp),
    ]
    n1_quydoi = max([x for x in n1_quydoi_list if x is not None], default=None)


    if n1_quydoi is not None:
        diem_mon["N1"] = max(diem_mon.get("N1", 0), n1_quydoi)

    n4_quydoi_list = [
        quy_doi_n4_tu_ccnn("HSK3", hsk3),
        quy_doi_n4_tu_ccnn("HSK4", hsk4),
        quy_doi_n4_tu_ccnn("HSK5", hsk5),
        quy_doi_n4_tu_ccnn("HSK6", hsk6),
    ]
    n4_quydoi = max([x for x in n4_quydoi_list if x is not None], default=None)

    if n4_quydoi is not None:
        diem_mon["N4"] = max(diem_mon.get("N4", 0), n4_quydoi)

    n7_quydoi_list = [
        quy_doi_n7_tu_ccnn("TOPIK II_N3", topikii_3),
    ]
    n7_quydoi = max([x for x in n7_quydoi_list if x is not None], default=None)

    if n7_quydoi is not None:
        diem_mon["N7"] = max(diem_mon.get("N7", 0), n7_quydoi)

    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        NGÀNH TÍNH ĐIỂM XÉT TUYỂN
    </div>
    """,
    unsafe_allow_html=True
)

    # 6. Chọn mã ngành

    ten_nganh = {
        "7340101": "Quản trị kinh doanh",
        "7340101C": "Quản trị kinh doanh Chương trình Tiên tiến",
        "7340101FL": "Quản trị kinh doanh - CTLK với Đại học Flinders, Úc",
        "7340101SQ": "Quản trị kinh doanh - CTLK Đại học Southern Queensland, Úc",
        "7340101SW": "Quản trị kinh doanh - CTLK Đại học South Wales, Vương Quốc Anh",
        "7340115": "Marketing",
        "7340120": "Kinh doanh quốc tế",
        "7340201": "Tài chính - Ngân hàng",
        "7340201C": "Tài chính - Ngân hàng Chương trình Tiên tiến",
        "7340201FL": "Tài chính ngân hàng - CTLK Đại học Flinders Úc",
        "7340204": "Bảo hiểm",
        "7340205": "Công nghệ tài chính",
        "7340301": "Kế toán",
        "7340301C": "Kế toán Chương trình Tiên tiến",
        "7340302": "Kiểm toán",
        "7340302C": "Kiểm toán Chương trình Tiên tiến",
        "7340403": "Quản lý công",
        "7340404": "Quản trị nhân lực",
        "7340405": "Hệ thống thông tin quản lý",
        "7380101": "Luật",
        "7380107": "Luật kinh tế",
        "7380107C": "Luật kinh tế Chương trình Tiên tiến",
        "7420201": "Công nghệ sinh học",
        "7420201C": "Công nghệ sinh học Chương trình Tiên tiến",
        "7460108": "Khoa học dữ liệu",
        "7480101": "Khoa học máy tính",
        "7480101C": "Khoa học máy tính Chương trình Tiên tiến",
        "7480107": "Trí tuệ nhân tạo",
        "7480103": "Kỹ thuật phần mềm",
        "7480201": "Công nghệ thông tin",
        "7480201C": "Công nghệ thông tin Chương trình Tiên tiến",
        "7510102": "Công nghệ kỹ thuật công trình xây dựng",
        "7510102C": "Công nghệ kỹ thuật công trình xây dựng Chương trình Tiên tiến",
        "7510605": "Logistics và quản lý chuỗi cung ứng",
        "7540101": "Công nghệ thực phẩm",
        "7580302": "Quản lý xây dựng",
        "7220201": "Ngôn ngữ Anh",
        "7220201C": "Ngôn ngữ Anh Chương trình Tiên tiến",
        "7220201FL": "Ngôn ngữ Anh - CTLK Đại học Flinders, Úc",
        "7220204": "Ngôn ngữ Trung Quốc",
        "7220204C": "Ngôn ngữ Trung Quốc Chương trình Tiên tiến",
        "7220209": "Ngôn ngữ Nhật",
        "7220209C": "Ngôn ngữ Nhật Chương trình Tiên tiến",
        "7220210": "Ngôn ngữ Hàn Quốc",
        "7310101": "Kinh tế",
        "7310101C": "Kinh tế Chương trình Tiên tiến",
        "7310301": "Xã hội học",
        "7310401": "Tâm lý học",
        "7310620": "Đông Nam Á học",
        "7760101": "Công tác xã hội",
        "7810101": "Du lịch",
    }

    options = [(code, ten_nganh.get(code, "Chưa có tên ngành")) for code in cau_hinh_xt.keys()]
    ma_nganh, ten = st.selectbox("Chọn mã ngành tính điểm", options, format_func=lambda x: f"{x[0]} - {x[1]}")

    #st.write(f"Bạn đã chọn ngành: {ten}")

    diem_san = diem_san_mac_dinh.get(ma_nganh, 0)

    # 7. Nút tính điểm

    if st.button("TÍNH ĐIỂM XÉT TUYỂN"):
        diem_cao_nhat = -1
        tohop_tot_nhat = None
        chi_tiet_diem = {}

        for tohop, mon_he_so in cau_hinh_xt[ma_nganh].items():
            cac_mon = list(mon_he_so.keys())
            diem_mon_thi = [diem_mon[m] for m in cac_mon if diem_mon.get(m, 0) > 0]
            if len(diem_mon_thi) < 3:
                continue

            if sum(sorted(diem_mon_thi, reverse=True)[:3]) + diem_uu_tien_kv + diem_uu_tien_dt < diem_san:
                continue

            diem_thi = tinh_diem_to_hop(diem_mon, ma_nganh, tohop)
            if diem_thi is None:
                continue

            # Lưu lại chi tiết tính toán
            diem_tohop = Decimal(str(diem_thi))
            diem_ccnn_cong = Decimal(str(diem_cong_ccnn))
            tong_diem_truoc_tong = diem_tohop + diem_ccnn_cong

            if tong_diem_truoc_tong >= 22.5:
                diem_kvut = (Decimal("30") - (tong_diem_truoc_tong)) / Decimal("7.5") * Decimal(str(diem_uu_tien_kv + diem_uu_tien_dt))
            else:
                diem_kvut = Decimal(str(diem_uu_tien_kv + diem_uu_tien_dt))

            tong_xt = lam_tron_tuy_chinh(diem_tohop + diem_ccnn_cong + diem_kvut)

            if tong_xt > diem_cao_nhat:
                diem_cao_nhat = tong_xt
                tohop_tot_nhat = tohop
                chi_tiet_diem = {
                    "diem_tohop": float(diem_tohop),
                    "diem_kv_dt": float(diem_kvut),
                    "n1_quydoi": n1_quydoi if n1_quydoi else None,
                    "diem_cong_ccnn": float(diem_ccnn_cong),
                    "tong_xt": float(tong_xt)
                }

        if tohop_tot_nhat:
            st.success(f"Tổ hợp cao nhất: {tohop_tot_nhat} ({', '.join(cau_hinh_xt[ma_nganh][tohop_tot_nhat].keys())})")
            st.write(f"1️⃣ Điểm tổ hợp cao nhất: {chi_tiet_diem['diem_tohop']}")
            st.write(f"2️⃣ Điểm quy đổi từ CCNN: {chi_tiet_diem['n1_quydoi'] if chi_tiet_diem['n1_quydoi'] else 'Không'}")
            st.write(f"3️⃣ Điểm cộng CCNN: {chi_tiet_diem['diem_cong_ccnn']}")
            st.write(f"4️⃣ Điểm cộng đối tượng và khu vực ưu tiên: {chi_tiet_diem['diem_kv_dt']}") 
            st.markdown(f"### 🟢 **TỔNG ĐIỂM XÉT TUYỂN: {chi_tiet_diem['tong_xt']}**")
        else:
            st.error("Không có tổ hợp nào đạt điểm sàn hoặc đủ điều kiện.")
    

with tab2:
    #st.header("Xử lý PTXT 2")

    st.markdown(
    "<h1 style='text-align: center; color: #003366;'>KẾT QUẢ KỲ THI ĐÁNH GIÁ ĐẦU VÀO ĐẠI HỌC V-SAT</h1>",
    unsafe_allow_html=True
    )

    diem_san_mac_dinh = {
        "7340101": 16.0, "7340101C": 16.0, "7340115": 16.0, "7340120": 16.0,
        "7340201": 16.0, "7340201C": 15.0, "7340204": 15.0, "7340205": 16.0,
        "7340301": 16.0, "7340301C": 15.0, "7340302": 16.0, "7340302C": 15.0,
        "7340403": 15.0, "7340404": 16.0, "7340405": 16.0, "7380101": 16.0,
        "7380107": 16.0, "7380107C": 16.0, "7420201": 15.0, "7420201C": 15.0,
        "7460108": 16.0, "7480101": 16.0, "7480101C": 16.0, "7480107": 16.0,
        "7480103": 16.0, "7480201": 16.0, "7480201C": 16.0, "7510102": 15.0,
        "7510102C": 15.0, "7510605": 16.0, "7540101": 15.0, "7580302": 15.0,
        "7220201": 16.0, "7220201C": 16.0, "7220204": 16.0, "7220204C": 16.0,
        "7220209": 16.0, "7220209C": 16.0, "7220210": 16.0, "7310101": 16.0,
        "7310101C": 15.0, "7310301": 15.0, "7310401": 16.0, "7310620": 15.0,
        "7760101": 15.0, "7810101": 16.0, "7220201FL": 15.0, "7340101FL": 15.0,
        "7340101SQ": 15.0, "7340101SW": 15.0, "7340201FL": 15.0
    }


    data_TO_VS = [
        {"a": 132, "b": 150, "c": 8.5, "d": 10},
        {"a": 128.5, "b": 132, "c": 8.1, "d": 8.5},
        {"a": 122.5, "b": 128.5, "c": 7.75, "d": 8.1},
        {"a": 114.5, "b": 122.5, "c": 7.0, "d": 7.75},
        {"a": 108, "b": 114.5, "c": 6.6, "d": 7.0},
        {"a": 102.5, "b": 108, "c": 6.25, "d": 6.6},
        {"a": 97, "b": 102.5, "c": 6.0, "d": 6.25},
        {"a": 91, "b": 97, "c": 5.6, "d": 6.0},
        {"a": 85, "b": 91, "c": 5.25, "d": 5.6},
        {"a": 77, "b": 85, "c": 5.0, "d": 5.25},
        {"a": 68, "b": 77, "c": 4.5, "d": 5.0},
        {"a": 6, "b": 68, "c": 1.5, "d": 4.5},
    ]

    data_LI_VS = [
        {"a": 123, "b": 147, "c": 9.5, "d": 10},
        {"a": 118.5, "b": 123, "c": 9.25, "d": 9.5},
        {"a": 112.5, "b": 118.5, "c": 9.0, "d": 9.25},
        {"a": 105, "b": 112.5, "c": 8.5, "d": 9.0},
        {"a": 99.5, "b": 105, "c": 8, "d": 8.5},
        {"a": 94.5, "b": 99.5, "c": 7.75, "d": 8},
        {"a": 90, "b": 94.5, "c": 7.5, "d": 7.75},
        {"a": 85, "b": 90, "c": 7.25, "d": 7.5},
        {"a": 80, "b": 85, "c": 6.75, "d": 7.25},
        {"a": 74, "b": 80, "c": 6.35, "d": 6.75},
        {"a": 66.5, "b": 74, "c": 5.75, "d": 6.35},
        {"a": 17, "b": 66.5, "c": 3.05, "d": 5.75},
    ]

    data_HO_VS = [
        {"a": 129, "b": 150, "c": 9.5, "d": 10},
        {"a": 124.5, "b": 129, "c": 9.25, "d": 9.5},
        {"a": 117, "b": 124.5, "c": 8.75, "d": 9.25},
        {"a": 107.5, "b": 117, "c": 8.25, "d": 8.75},
        {"a": 100.5, "b": 107.5, "c": 7.75, "d": 8.25},
        {"a": 94, "b": 100.5, "c": 7.25, "d": 7.75},
        {"a": 88, "b": 94, "c": 6.75, "d": 7.25},
        {"a": 81.5, "b": 88, "c": 6.25, "d": 6.75},
        {"a": 75.5, "b": 81.5, "c": 5.75, "d": 6.25},
        {"a": 68.5, "b": 75.5, "c": 5.25, "d": 5.75},
        {"a": 59.5, "b": 68.5, "c": 4.6, "d": 5.25},
        {"a": 20, "b": 59.5, "c": 1.35, "d": 4.6},
    ]

    data_SI_VS = [
        {"a": 130.5, "b": 150, "c": 9, "d": 9.75},
        {"a": 126.5, "b": 130.5, "c": 8.75, "d": 9},
        {"a": 120.5, "b": 126.5, "c": 8.34, "d": 8.75},
        {"a": 112.5, "b": 120.5, "c": 7.85, "d": 8.34},
        {"a": 105.5, "b": 112.5, "c": 7.5, "d": 7.85},
        {"a": 100, "b": 105.5, "c": 7.25, "d": 7.5},
        {"a": 94.5, "b": 100, "c": 6.85, "d": 7.25},
        {"a": 88.5, "b": 94.5, "c": 6.5, "d": 6.85},
        {"a": 82.5, "b": 88.5, "c": 6.25, "d": 6.5},
        {"a": 76, "b": 82.5, "c": 5.85, "d": 6.25},
        {"a": 66.5, "b": 76, "c": 5.25, "d": 5.85},
        {"a": 26.5, "b": 66.5, "c": 2.8, "d": 5.25},
    ]

    data_SU_VS = [
        {"a": 133.5, "b": 150, "c": 9.75, "d": 10},
        {"a": 131.0, "b": 133.5, "c": 9.5, "d": 9.75},
        {"a": 126.5, "b": 131.0, "c": 9.25, "d": 9.5},
        {"a": 120.5, "b": 126.5, "c": 9, "d": 9.25},
        {"a": 115, "b": 120.5, "c": 8.5, "d": 9},
        {"a": 110, "b": 115.0, "c": 8.25, "d": 8.5},
        {"a": 105.5, "b": 110, "c": 8, "d": 8.25},
        {"a": 101.0, "b": 105.5, "c": 7.75, "d": 8},
        {"a": 95.5, "b": 101, "c": 7.5, "d": 7.75},
        {"a": 88.5, "b": 95.5, "c": 7, "d": 7.5},
        {"a": 79.5, "b": 88.5, "c": 6.35, "d": 7},
        {"a": 36.5, "b": 79.5, "c": 2.95, "d": 6.35},
    ]

    data_DI_VS = [
        {"a": 124, "b": 141, "c": 10, "d": 10},
        {"a": 120.5, "b": 124, "c": 10, "d": 10},
        {"a": 115.5, "b": 120.5, "c": 9.75, "d": 10},
        {"a": 108.5, "b": 115.5, "c": 9.25, "d": 9.75},
        {"a": 103, "b": 108.5, "c": 9, "d": 9.25},
        {"a": 98.5, "b": 103, "c": 8.75, "d": 9},
        {"a": 94, "b": 98.5, "c": 8.5, "d": 8.75},
        {"a": 89.5, "b": 94, "c": 8.25, "d": 8.5},
        {"a": 84.5, "b": 89.5, "c": 7.75, "d": 8.25},
        {"a": 79, "b": 84.5, "c": 7.25, "d": 7.75},
        {"a": 71, "b": 79, "c": 6.5, "d": 7.25},
        {"a": 31, "b": 71, "c": 3, "d": 6.5},
    ]

    data_N1_VS = [
        {"a": 131, "b": 150, "c": 7.75, "d": 9.75},
        {"a": 127.5, "b": 131, "c": 7.5, "d": 7.75},
        {"a": 120.5, "b": 127.5, "c": 7, "d": 7.5},
        {"a": 112.0, "b": 120.5, "c": 6.5, "d": 7},
        {"a": 105, "b": 112, "c": 6, "d": 6.5},
        {"a": 98.5, "b": 105, "c": 5.75, "d": 6},
        {"a": 92, "b": 98.5, "c": 5.5, "d": 5.75},
        {"a": 85.5, "b": 92, "c": 5.25, "d": 5.5},
        {"a": 78.5, "b": 85.5, "c": 5, "d": 5.25},
        {"a": 70.5, "b": 78.5, "c": 4.5, "d": 5},
        {"a": 60, "b": 70.5, "c": 4, "d": 4.5},
        {"a": 20.5, "b": 60, "c": 1.25, "d": 4},
    ]

    data_VA_VS = [
        {"a": 129.5, "b": 146, "c": 9.25, "d": 9.75},
        {"a": 127.5, "b": 129.5, "c": 9.0, "d": 9.25},
        {"a": 124.0, "b": 127.5, "c": 9.0, "d": 9.0},
        {"a": 119.5, "b": 124.0, "c": 8.75, "d": 9},
        {"a": 115.5, "b": 119.5, "c": 8.5, "d": 8.75},
        {"a": 112.5, "b": 115.5, "c": 8.25, "d": 8.5},
        {"a": 109, "b": 112.5, "c": 8, "d": 8.25},
        {"a": 106, "b": 109, "c": 7.75, "d": 8.0},
        {"a": 102, "b": 106, "c": 7.5, "d": 7.75},
        {"a": 97, "b": 102, "c": 7.25, "d": 7.5},
        {"a": 90, "b": 97, "c": 6.75, "d": 7.25},
        {"a": 5, "b": 90, "c": 3.5, "d": 6.75},
    ]

    bang_quydoi = {
        "TO": data_TO_VS,
        "LI": data_LI_VS,
        "HO": data_HO_VS,
        "SI": data_SI_VS,
        "SU": data_SU_VS,
        "DI": data_DI_VS,
        "N1": data_N1_VS,
        "VA": data_VA_VS,
    }

    cau_hinh_xt = {
        "7220201": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7220204": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220209": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220210": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7310101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7310301": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7310401": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7310620": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },    
        "7340101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340115": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340120": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340204": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340205": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "AH2": {"TO": 1, "HO": 1, "N7": 1},
            "AH3": {"TO": 1, "LI": 1, "N7": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D21": {"TO": 1, "HO": 1, "N5": 1},
            "D25": {"TO": 1, "HO": 1, "N4": 1},
            "D26": {"TO": 1, "LI": 1, "N5": 1},
            "D27": {"TO": 1, "LI": 1, "N2": 1},
            "D28": {"TO": 1, "LI": 1, "N6": 1},
            "D29": {"TO": 1, "LI": 1, "N3": 1},
            "D30": {"TO": 1, "LI": 1, "N4": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X03": {"TO": 1, "VA": 1, "CNCN": 1},
            "X04": {"TO": 1, "VA": 1, "CNNN": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X08": {"TO": 1, "LI": 1, "CNNN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
        },
        "7340301": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D84": {"TO": 1, "N1": 1, "GDCD": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X25": {"TO": 1, "N1": 1, "KTPL": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1}, 
        },
        "7340302": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D84": {"TO": 1, "N1": 1, "GDCD": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X25": {"TO": 1, "N1": 1, "KTPL": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1}, 
        },
        "7340403": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X07": {"TO": 1, "LI": 1, "CNCN": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7340404": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340405": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7380101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
        },
        "7380107": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
        },
        "7420201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X57": {"TO": 1, "TI": 1, "CNNN": 1},
        },
        "7460108": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480103": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480107": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7480201": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C01": {"TO": 1, "VA": 1, "LI": 1},
            "C02": {"TO": 1, "VA": 1, "HO": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X02": {"TO": 1, "VA": 1, "TI": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
        },
        "7510102": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7510605": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D10": {"TO": 1, "DI": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X22": {"TO": 1, "DI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7540101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
        },
        "7580302": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7760101": {
            "C00": {"VA": 1, "SU": 1, "DI": 1},
            "C14": {"TO": 1, "VA": 1, "GDCD": 1},
            "C19": {"VA": 1, "SU": 1, "GDCD": 1},
            "C20": {"VA": 1, "DI": 1, "GDCD": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D02": {"TO": 1, "VA": 1, "N2": 1},
            "D03": {"TO": 1, "VA": 1, "N3": 1},
            "D04": {"TO": 1, "VA": 1, "N4": 1},
            "D05": {"TO": 1, "VA": 1, "N5": 1},
            "D06": {"TO": 1, "VA": 1, "N6": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "D41": {"VA": 1, "DI": 1, "N5": 1},
            "D42": {"VA": 1, "DI": 1, "N2": 1},
            "D43": {"VA": 1, "DI": 1, "N6": 1},
            "D44": {"VA": 1, "DI": 1, "N3": 1},
            "D45": {"VA": 1, "DI": 1, "N4": 1},
            "D61": {"VA": 1, "SU": 1, "N5": 1},
            "D62": {"VA": 1, "SU": 1, "N2": 1},
            "D63": {"VA": 1, "SU": 1, "N6": 1},
            "D64": {"VA": 1, "SU": 1, "N3": 1},
            "D65": {"VA": 1, "SU": 1, "N4": 1},
            "D66": {"VA": 1, "N1": 1, "GDCD": 1},
            "D67": {"VA": 1, "N5": 1, "GDCD": 1},
            "D68": {"VA": 1, "N2": 1, "GDCD": 1},
            "D69": {"VA": 1, "N6": 1, "GDCD": 1},
            "D70": {"VA": 1, "N3": 1, "GDCD": 1},
            "D71": {"VA": 1, "N4": 1, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 1},
            "DH1": {"TO": 1, "DI": 1, "N7": 1},
            "DH5": {"VA": 1, "SU": 1, "N7": 1},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 1},
            "X01": {"TO": 1, "VA": 1, "KTPL": 1},
            "X70": {"VA": 1, "SU": 1, "KTPL": 1},
            "X74": {"VA": 1, "DI": 1, "KTPL": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
            "X82": {"VA": 1, "N2": 1, "KTPL": 1},
            "X86": {"VA": 1, "N6": 1, "KTPL": 1},
            "X90": {"VA": 1, "N4": 1, "KTPL": 1},
            "X94": {"VA": 1, "N5": 1, "KTPL": 1},
            "X98": {"VA": 1, "N6": 1, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 1, "KTPL": 1},
        },
        "7810101": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "C03": {"TO": 1, "VA": 1, "SU": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "D10": {"TO": 1, "DI": 1, "N1": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "X06": {"TO": 1, "LI": 1, "TI": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
        },
        "7220201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7220204C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7220209C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "AH2": {"TO": 1, "HO": 1, "N7": 2},
            "AH3": {"TO": 1, "LI": 1, "N7": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D02": {"TO": 1, "VA": 1, "N2": 2},
            "D03": {"TO": 1, "VA": 1, "N3": 2},
            "D04": {"TO": 1, "VA": 1, "N4": 2},
            "D05": {"TO": 1, "VA": 1, "N5": 2},
            "D06": {"TO": 1, "VA": 1, "N6": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D15": {"VA": 1, "DI": 1, "N1": 2},
            "D21": {"TO": 1, "HO": 1, "N5": 2},
            "D22": {"TO": 1, "HO": 1, "N2": 2},
            "D23": {"TO": 1, "HO": 1, "N6": 2},
            "D24": {"TO": 1, "HO": 1, "N3": 2},
            "D25": {"TO": 1, "HO": 1, "N4": 2},
            "D26": {"TO": 1, "LI": 1, "N5": 2},
            "D27": {"TO": 1, "LI": 1, "N2": 2},
            "D28": {"TO": 1, "LI": 1, "N6": 2},
            "D29": {"TO": 1, "LI": 1, "N3": 2},
            "D30": {"TO": 1, "LI": 1, "N4": 2},
            "D41": {"VA": 1, "DI": 1, "N5": 2},
            "D42": {"VA": 1, "DI": 1, "N2": 2},
            "D43": {"VA": 1, "DI": 1, "N6": 2},
            "D44": {"VA": 1, "DI": 1, "N3": 2},
            "D45": {"VA": 1, "DI": 1, "N4": 2},
            "D61": {"VA": 1, "SU": 1, "N5": 2},
            "D62": {"VA": 1, "SU": 1, "N2": 2},
            "D63": {"VA": 1, "SU": 1, "N6": 2},
            "D64": {"VA": 1, "SU": 1, "N3": 2},
            "D65": {"VA": 1, "SU": 1, "N4": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D67": {"VA": 1, "N5": 2, "GDCD": 1},
            "D68": {"VA": 1, "N2": 2, "GDCD": 1},
            "D69": {"VA": 1, "N6": 2, "GDCD": 1},
            "D70": {"VA": 1, "N3": 2, "GDCD": 1},
            "D71": {"VA": 1, "N4": 2, "GDCD": 1},
            "DD2": {"TO": 1, "VA": 1, "N7": 2},
            "DH1": {"VA": 1, "DI": 1, "N7": 2},
            "DH5": {"VA": 1, "SU": 1, "N7": 2},
            "DH6": {"VA": 1, "GDCD": 1, "N7": 2},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X82": {"VA": 1, "N2": 2, "KTPL": 1},
            "X86": {"VA": 1, "N3": 2, "KTPL": 1},
            "X90": {"VA": 1, "N4": 2, "KTPL": 1},
            "X94": {"VA": 1, "N5": 2, "KTPL": 1},
            "X98": {"VA": 1, "N6": 2, "KTPL": 1},
            "Y03": {"VA": 1, "N7": 2, "KTPL": 1},
        },
        "7310101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
        },
        "7340101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7340201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "D10": {"TO": 1, "DI": 1, "N1": 2},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7340301C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7340302C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
            "X79": {"VA": 1, "N1": 2, "TI": 1},    
        },
        "7380107C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D09": {"TO": 1, "SU": 1, "N1": 2},
            "D14": {"VA": 1, "SU": 1, "N1": 2},
            "D66": {"VA": 1, "N1": 2, "GDCD": 1},
            "D84": {"TO": 1, "N1": 2, "GDCD": 1},
            "X25": {"TO": 1, "N1": 2, "KTPL": 1},
            "X78": {"VA": 1, "N1": 2, "KTPL": 1},
        },
        "7420201C": {
            "A00": {"TO": 1, "LI": 1, "HO": 1},
            "B00": {"TO": 1, "HO": 1, "SI": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "X10": {"TO": 1, "HO": 1, "TI": 1},
            "X11": {"TO": 1, "HO": 1, "CNCN": 1},
            "X12": {"TO": 1, "HO": 1, "CNNN": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X28": {"TO": 1, "N1": 1, "CNNN": 1},
            "X56": {"TO": 1, "TI": 1, "CNCN": 1},
        },
        "7480101C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7480201C": {
            "A01": {"TO": 1, "LI": 1, "N1": 2},
            "B08": {"TO": 1, "SI": 1, "N1": 2},
            "D01": {"TO": 1, "VA": 1, "N1": 2},
            "D07": {"TO": 1, "HO": 1, "N1": 2},
            "X26": {"TO": 1, "N1": 2, "TI": 1},
            "X27": {"TO": 1, "N1": 2, "CNCN": 1},
            "X28": {"TO": 1, "N1": 2, "CNNN": 1},
        },
        "7510102C": {
            "A00": {"TO": 2, "LI": 1, "HO": 1},
            "A01": {"TO": 2, "LI": 1, "N1": 1},
            "D07": {"TO": 2, "HO": 1, "N1": 1},
            "X06": {"TO": 2, "LI": 1, "TI": 1},
            "X07": {"TO": 2, "LI": 1, "CNCN": 1},
            "X10": {"TO": 2, "HO": 1, "TI": 1},
            "X11": {"TO": 2, "HO": 1, "CNCN": 1},
            "X26": {"TO": 2, "N1": 1, "TI": 1},
            "X27": {"TO": 2, "N1": 1, "CNCN": 1},
            "X56": {"TO": 2, "TI": 1, "CNCN": 1},
        },
        "7220201FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D14": {"VA": 1, "SU": 1, "N1": 1},
            "D15": {"VA": 1, "DI": 1, "N1": 1},
            "X78": {"VA": 1, "N1": 1, "KTPL": 1},
        },
        "7340101FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "B08": {"TO": 1, "SI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        }, 
        "7340101SQ": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340101SW": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        },
        "7340201FL": {
            "A01": {"TO": 1, "LI": 1, "N1": 1},
            "D01": {"TO": 1, "VA": 1, "N1": 1},
            "D07": {"TO": 1, "HO": 1, "N1": 1},
            "D08": {"TO": 1, "SI": 1, "N1": 1},
            "D09": {"TO": 1, "SU": 1, "N1": 1},
            "X26": {"TO": 1, "N1": 1, "TI": 1},
            "X27": {"TO": 1, "N1": 1, "CNCN": 1},
            "X79": {"VA": 1, "N1": 1, "TI": 1},
        }
    }


    def lam_tron_tuy_chinh(value):
        return float(
            Decimal(value)
            .quantize(Decimal("0.001"), rounding=ROUND_HALF_UP)
            .quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)
        )


    def quy_doi(x, data):
        try:
            x = float(x)
        except Exception:
            return None
        for row in data:
            a, b, c, d = row["a"], row["b"], row["c"], row["d"]
            # Áp dụng điều kiện a < x <= b tương tự code gốc
            if a < x <= b:
                y = c + ((x - a) / (b - a)) * (d - c)
                return round(y, 2)
        return None


    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        NHẬP TẤT CẢ CÁC ĐIỂM MÔN THI VSAT
        <span style="color: yellow;">(Nhập cùng 1 đợt thi do CSĐT tổ chức thi)</span>
    </div>
    """,
    unsafe_allow_html=True
    )


    mon_hoc = ["TO", "LI", "HO", "SI", "SU", "DI", "VA", "N1"]
    mon_fullname = {"TO":"Toán","LI":"Vật lí ","HO":"Hóa học","SI":"Sinh học","SU":"Lịch sử","DI":"Địa lí","VA":"Ngữ văn","N1":"Tiếng Anh"}

    cols = st.columns(4)
    for i, mon in enumerate(mon_hoc):
        with cols[i % 4]:
            st.number_input(mon_fullname[mon], min_value=0.0, max_value=150.0 if mon in bang_quydoi else 10.0, key=f"m_{mon}", step=0.1)

    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        ĐỐI TƯỢNG VÀ KHU VỰC ƯU TIÊN
    </div>
    """,
    unsafe_allow_html=True
)

    khu_vuc = st.selectbox("Khu vực ưu tiên", ["Không", "KV1", "KV2NT", "KV2", "KV3"], key="khu_vuc_1")
    doi_tuong = st.selectbox("Đối tượng ưu tiên", ["Không", "ĐT01", "ĐT02", "ĐT03", "ĐT04", "ĐT05", "ĐT06", "ĐT07"], key="selectbox_doi_tuong_1")


    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        CHỨNG CHỈ QUỐC TẾ
    </div>
    """,
    unsafe_allow_html=True
)


    ielts_1 = st.number_input("IELTS Academic", min_value=0.0, max_value=9.0, step=0.5, format="%.1f", value=0.0, key="ielts_1")
    toefl_ibt_1 = st.number_input("TOEFL iBT", min_value=0, max_value=150, step=1, value=0, key="toefl_ibt_1")
    toefl_itp_1 = st.number_input("TOEFL ITP", min_value=0, max_value=100, step=1, value=0, key="toefl_itp_1")
    hsk3_1 = st.number_input("HSK3", min_value=0, max_value=300, step=1, value=0, key="hsk3_1")
    hsk4_1 = st.number_input("HSK4", min_value=0, max_value=300, step=1, value=0, key="hsk4_1")
    hsk5_1 = st.number_input("HSK5", min_value=0, max_value=300, step=1, value=0, key="hsk5_1")
    hsk6_1 = st.number_input("HSK6", min_value=0, max_value=300, step=1, value=0, key="hsk6_1")
    jlpt_n1_1 = st.number_input("JLPT_N1", min_value=0, max_value=300, step=1, value=0, key="jlpt_n1_1")
    jlpt_n2_1 = st.number_input("JLPT_N2", min_value=0, max_value=300, step=1, value=0, key="jlpt_n2_1")
    jlpt_n3_1 = st.number_input("JLPT_N3", min_value=0, max_value=300, step=1, value=0, key="jlpt_n3_1")
    topikii_3_1 = st.number_input("TOPIK II_N3", min_value=0, max_value=300, step=1, value=0, key="topikii_3_1")
    topikii_4_1 = st.number_input("TOPIK II_N4", min_value=0, max_value=300, step=1, value=0, key="topikii_4_1")
    topikii_5_1 = st.number_input("TOPIK II_N5", min_value=0, max_value=300, step=1, value=0, key="topikii_5_1")
    topikii_6_1 = st.number_input("TOPIK II_N6", min_value=0, max_value=300, step=1, value=0, key="topikii_6_1")


    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        NGÀNH TÍNH ĐIỂM XÉT TUYỂN
    </div>
    """,
    unsafe_allow_html=True
)


    ten_nganh = {
        "7340101": "Quản trị kinh doanh",
        "7340101C": "Quản trị kinh doanh Chương trình Tiên tiến",
        "7340101FL": "Quản trị kinh doanh - CTLK với Đại học Flinders, Úc",
        "7340101SQ": "Quản trị kinh doanh - CTLK Đại học Southern Queensland, Úc",
        "7340101SW": "Quản trị kinh doanh - CTLK Đại học South Wales, Vương Quốc Anh",
        "7340115": "Marketing",
        "7340120": "Kinh doanh quốc tế",
        "7340201": "Tài chính - Ngân hàng",
        "7340201C": "Tài chính - Ngân hàng Chương trình Tiên tiến",
        "7340201FL": "Tài chính ngân hàng - CTLK Đại học Flinders Úc",
        "7340204": "Bảo hiểm",
        "7340205": "Công nghệ tài chính",
        "7340301": "Kế toán",
        "7340301C": "Kế toán Chương trình Tiên tiến",
        "7340302": "Kiểm toán",
        "7340302C": "Kiểm toán Chương trình Tiên tiến",
        "7340403": "Quản lý công",
        "7340404": "Quản trị nhân lực",
        "7340405": "Hệ thống thông tin quản lý",
        "7380101": "Luật",
        "7380107": "Luật kinh tế",
        "7380107C": "Luật kinh tế Chương trình Tiên tiến",
        "7420201": "Công nghệ sinh học",
        "7420201C": "Công nghệ sinh học Chương trình Tiên tiến",
        "7460108": "Khoa học dữ liệu",
        "7480101": "Khoa học máy tính",
        "7480101C": "Khoa học máy tính Chương trình Tiên tiến",
        "7480107": "Trí tuệ nhân tạo",
        "7480103": "Kỹ thuật phần mềm",
        "7480201": "Công nghệ thông tin",
        "7480201C": "Công nghệ thông tin Chương trình Tiên tiến",
        "7510102": "Công nghệ kỹ thuật công trình xây dựng",
        "7510102C": "Công nghệ kỹ thuật công trình xây dựng Chương trình Tiên tiến",
        "7510605": "Logistics và quản lý chuỗi cung ứng",
        "7540101": "Công nghệ thực phẩm",
        "7580302": "Quản lý xây dựng",
        "7220201": "Ngôn ngữ Anh",
        "7220201C": "Ngôn ngữ Anh Chương trình Tiên tiến",
        "7220201FL": "Ngôn ngữ Anh - CTLK Đại học Flinders, Úc",
        "7220204": "Ngôn ngữ Trung Quốc",
        "7220204C": "Ngôn ngữ Trung Quốc Chương trình Tiên tiến",
        "7220209": "Ngôn ngữ Nhật",
        "7220209C": "Ngôn ngữ Nhật Chương trình Tiên tiến",
        "7220210": "Ngôn ngữ Hàn Quốc",
        "7310101": "Kinh tế",
        "7310101C": "Kinh tế Chương trình Tiên tiến",
        "7310301": "Xã hội học",
        "7310401": "Tâm lý học",
        "7310620": "Đông Nam Á học",
        "7760101": "Công tác xã hội",
        "7810101": "Du lịch",
    }

    options = [(code, ten_nganh.get(code, "Chưa có tên ngành")) for code in cau_hinh_xt.keys()]
    ma_nganh, ten = st.selectbox("Chọn mã ngành tính điểm", options, format_func=lambda x: f"{x[0]} - {x[1]}", key="selectbox_manganh_tinhdiem")

    if doi_tuong in ["ĐT01", "ĐT02", "ĐT03", "ĐT04"]:
        diem_uu_tien_dt = 2.0
    elif doi_tuong in ["ĐT05", "ĐT06", "ĐT07"]:
        diem_uu_tien_dt = 1.0
    else:
        diem_uu_tien_dt = 0.0

    # Tính điểm KV
    diem_uu_tien_kv = {"Không": 0.0, "KV1": 0.75, "KV2NT": 0.5, "KV2": 0.25, "KV3": 0.0}[khu_vuc]

    diem_kv_dt = diem_uu_tien_kv + diem_uu_tien_dt

    n1_quydoi = None
    n4_quydoi = None
    diem_cong_ccnn = 0.0

    def tinh_diem_cong_ccnn(loai_ccnn, diem):
        if loai_ccnn == "IELTS Academic":
            if diem >= 8.5:
                return 2.0
            elif diem >= 8.0:
                return 1.5
            elif 7.0 <= diem <= 7.5:
                return 1.0
            elif 6.0 <= diem <= 6.5:
                return 0.5
        elif loai_ccnn == "TOEFL iBT":
            if diem >= 79:
                return 2.0
            elif 60 <= diem <= 78:
                return 1.5
            elif 46 <= diem <= 59:
                return 1.0
        elif loai_ccnn == "TOEFL ITP":
            if diem >= 547:
                return 2.0
            elif 520 <= diem <= 546:
                return 1.5
            elif 513 <= diem <= 517:
                return 1.0
            elif 490 <= diem <= 510:
                return 0.5
        elif loai_ccnn == "HSK3":
            if diem >= 180:
                return 0.5
        elif loai_ccnn == "HSK4":
            if diem >= 180:
                return 1
        elif loai_ccnn == "HSK5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "HSK6":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N1":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N2":
            if diem >= 150:
                return 1.5
        elif loai_ccnn == "JLPT_N2":
            if diem >= 90:
                return 1
        elif loai_ccnn == "JLPT_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N4":
            if diem >= 1:
                return 1
        elif loai_ccnn == "TOPIK II_N5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "TOPIK II_N6":
            if diem >= 1:
                return 2
        return 0.0

    def quy_doi_n1_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "IELTS Academic":
            if diem >= 6.5:
                return 10
            elif diem == 6.0:
                return 9
            elif diem == 5.5:
                return 8
            elif diem == 5.0:
                return 7
        elif loai_ccnn == "TOEFL iBT":
            if diem >= 79:
                return 10
            elif 60 <= diem <= 78:
                return 9
            elif 46 <= diem <= 59:
                return 8
            elif 35 <= diem <= 45:
                return 7
        elif loai_ccnn == "TOEFL ITP":
            if diem >= 547:
                return 10
            elif 520 <= diem <= 543:
                return 9
            elif 513 <= diem <= 517:
                return 8
            elif 490 <= diem <= 510:
                return 7
        return None

    def quy_doi_n4_tu_ccnn(loai_ccnn, diem):
        if loai_ccnn == "HSK3":
            if 261 <= diem <= 300:
                return 9
            elif 221 <= diem <= 260:
                return 8
            elif 180 <= diem <= 220:
                return 7
        elif loai_ccnn == "HSK4":
            if diem >= 180:
                return 10
        elif loai_ccnn == "HSK5":
            if diem >= 1:
                return 10
        elif loai_ccnn == "HSK6":
            if diem >= 1:
                return 10
        return None


    def tinh_diem_to_hop(mon_goc, ma_nganh, tohop):
        if ma_nganh not in cau_hinh_xt or tohop not in cau_hinh_xt[ma_nganh]:
            return None, None

        mon_he_so = cau_hinh_xt[ma_nganh][tohop]
        diem_quy_doi = {}
        tong_diem_xt = 0.0
        tong_he_so = 0.0

        for mon, he_so in mon_he_so.items():
            diem_thi_raw = mon_goc.get(mon)

            if mon == "N1":
                diem_quydoi_tu_diem_thi = None
                if diem_thi_raw is not None and diem_thi_raw != 0:
                    diem_quydoi_tu_diem_thi = quy_doi(diem_thi_raw, bang_quydoi.get("N1", []))
     
                candidates = []
                if diem_quydoi_tu_diem_thi is not None:
                    candidates.append(diem_quydoi_tu_diem_thi)
                if n1_quydoi is not None:
                    candidates.append(n1_quydoi)
                if candidates:
                    diem = max(candidates)
                else:
                    return None, None  
            elif mon == "N4":
                diem_quydoi_tu_diem_thi = None
                if diem_thi_raw is not None and diem_thi_raw != 0:
                    diem_quydoi_tu_diem_thi = quy_doi(diem_thi_raw, bang_quydoi.get("N4", []))
     
                candidates = []
                if diem_quydoi_tu_diem_thi is not None:
                    candidates.append(diem_quydoi_tu_diem_thi)
                if n1_quydoi is not None:
                    candidates.append(n4_quydoi)
                if candidates:
                    diem = max(candidates)
                else:
                    return None, None 

            elif mon in bang_quydoi:
                if diem_thi_raw is None or pd.isna(diem_thi_raw) or diem_thi_raw == 0:
                    return None, None
                diem = quy_doi(diem_thi_raw, bang_quydoi[mon])
                if diem is None:
                    return None, None

            else:
                if diem_thi_raw is None or pd.isna(diem_thi_raw) or diem_thi_raw == 0:
                    return None, None
                diem = float(diem_thi_raw)

            diem_quy_doi[mon] = diem
            tong_diem_xt += diem * he_so
            tong_he_so += he_so
        danh_sach_diem_khong_heso = sorted(diem_quy_doi.values(), reverse=True)
        if len(danh_sach_diem_khong_heso) < 3:
            return None, None
        tong_3_mon = sum(danh_sach_diem_khong_heso[:3])

        diem_kvut_raw = diem_kv_dt
        tong_san = tong_3_mon + diem_kvut_raw
        diem_san = diem_san_mac_dinh.get(ma_nganh, 0)

        if tong_san < diem_san:
            return None, None

        diem_tohop = tong_diem_xt * 3.0 / tong_he_so

        diem_cong = diem_cong_ccnn

        tong_diem_truoc_tong = diem_tohop + diem_cong

        if tong_diem_truoc_tong >= 22.5:
            diem_kvut = ((30 - tong_diem_truoc_tong) / 7.5) * diem_kvut_raw
        else:
            diem_kvut = diem_kvut_raw

        tong_diem_xt = diem_tohop + diem_cong_ccnn + diem_kvut
        tong_diem_xt = lam_tron_tuy_chinh(tong_diem_xt)

        chi_tiet = {
            "diem_tohop": diem_tohop,
            "diem_quy_doi_theo_mon": diem_quy_doi,
            "n1_quydoi": n1_quydoi,
            "diem_cong_ccnn": diem_cong_ccnn,
            "diem_kv_dt": diem_kvut_raw,
            "diem_kv_dt_applied": diem_kvut,
            "tong_xt": tong_diem_xt,
        }

        return tong_diem_xt, chi_tiet
    def tinh_diem_to_hop(mon_goc, ma_nganh, tohop):
        if ma_nganh not in cau_hinh_xt or tohop not in cau_hinh_xt[ma_nganh]:
            return None, "Mã ngành hoặc tổ hợp không hợp lệ"

        mon_he_so = cau_hinh_xt[ma_nganh][tohop]
        diem_quy_doi = {}
        tong_diem_xt = 0.0
        tong_he_so = 0.0

        for mon, he_so in mon_he_so.items():
            diem_thi_raw = mon_goc.get(mon)

            if diem_thi_raw is None or pd.isna(diem_thi_raw) or diem_thi_raw == 0:
                return None, f"Thiếu điểm môn {mon_fullname.get(mon, mon)} trong tổ hợp {tohop}"

            if mon == "N1":
                diem_quydoi_tu_diem_thi = quy_doi(diem_thi_raw, bang_quydoi.get("N1", []))
                candidates = []
                if diem_quydoi_tu_diem_thi is not None:
                    candidates.append(diem_quydoi_tu_diem_thi)
                if n1_quydoi is not None:
                    candidates.append(n1_quydoi)
                if candidates:
                    diem = max(candidates)
                else:
                    return None, "Không có điểm N1 hợp lệ"
            elif mon == "N4":
                diem_quydoi_tu_diem_thi = quy_doi(diem_thi_raw, bang_quydoi.get("N4", []))
                candidates = []
                if diem_quydoi_tu_diem_thi is not None:
                    candidates.append(diem_quydoi_tu_diem_thi)
                if n4_quydoi is not None:
                    candidates.append(n4_quydoi)
                if candidates:
                    diem = max(candidates)
                else:
                    return None, "Không có điểm N4 hợp lệ"
            elif mon in bang_quydoi:
                diem = quy_doi(diem_thi_raw, bang_quydoi[mon])
                if diem is None:
                    return None, f"Điểm môn {mon_fullname.get(mon, mon)} không hợp lệ để quy đổi"
            else:
                diem = float(diem_thi_raw)

            diem_quy_doi[mon] = diem
            tong_diem_xt += diem * he_so
            tong_he_so += he_so

        danh_sach_diem_khong_heso = sorted(diem_quy_doi.values(), reverse=True)
        if len(danh_sach_diem_khong_heso) < 3:
            return None, "Không đủ 3 môn để tính điểm sàn"

        tong_3_mon = sum(danh_sach_diem_khong_heso[:3])
        diem_kvut_raw = diem_kv_dt
        tong_san = tong_3_mon + diem_kvut_raw
        diem_san = diem_san_mac_dinh.get(ma_nganh, 0)

        if tong_san < diem_san:
            return None, "Điểm chưa đạt điểm sàn"

        diem_tohop = tong_diem_xt * 3.0 / tong_he_so

        diem_cong = diem_cong_ccnn
        tong_diem_truoc_tong = diem_tohop + diem_cong

        if tong_diem_truoc_tong >= 22.5:
            diem_kvut = ((30 - tong_diem_truoc_tong) / 7.5) * diem_kvut_raw
        else:
            diem_kvut = diem_kvut_raw

        tong_diem_xt = diem_tohop + diem_cong_ccnn + diem_kvut
        tong_diem_xt = lam_tron_tuy_chinh(tong_diem_xt)

        chi_tiet = {
            "diem_tohop": diem_tohop,
            "diem_quy_doi_theo_mon": diem_quy_doi,
            "n1_quydoi": n1_quydoi,
            "diem_cong_ccnn": diem_cong_ccnn,
            "diem_kv_dt": diem_kvut_raw,
            "diem_kv_dt_applied": diem_kvut,
            "tong_xt": tong_diem_xt,
        }

        return tong_diem_xt, chi_tiet



    # CSS cho nút
    st.markdown("""
        <style>
        /* Canh giữa toàn bộ container của nút */
        div[data-testid="stHorizontalBlock"] div.stButton {
            display: flex;
            justify-content: center;
        }

        /* Style cho nút */
        div.stButton > button {
            background-color: #003366; /* Xanh đậm */
            color: white;
            font-weight: bold;
            border-radius: 8px;
            padding: 10px 20px;
            border: none;
        }
        </style>
    """, unsafe_allow_html=True)

    # Nút bấm
    if st.button("TÍNH ĐIỂM XÉT TUYỂN", key="btn_tinh_tohop_1"):

        mon_goc = {}
        for mon in mon_hoc:
            mon_goc[mon] = st.session_state.get(f"m_{mon}", 0)

        list_diem_cong = []
        list_n1_quydoi = []
        list_n4_quydoi = []

        if ielts_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("IELTS Academic", ielts_1))
            n1_tmp = quy_doi_n1_tu_ccnn("IELTS Academic", ielts_1)
            if n1_tmp is not None:
                list_n1_quydoi.append(n1_tmp)

        if toefl_ibt_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOEFL iBT", toefl_ibt_1))
            n1_tmp = quy_doi_n1_tu_ccnn("TOEFL iBT", toefl_ibt_1)
            if n1_tmp is not None:
                list_n1_quydoi.append(n1_tmp)

        if toefl_itp_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOEFL ITP", toefl_itp_1))
            n1_tmp = quy_doi_n1_tu_ccnn("TOEFL ITP", toefl_itp_1)
            if n1_tmp is not None:
                list_n1_quydoi.append(n1_tmp)

        if hsk3_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("HSK3", hsk3_1))
            n4_tmp = quy_doi_n4_tu_ccnn("HSK3", hsk3_1)
            if n4_tmp is not None:
                list_n4_quydoi.append(n4_tmp)

        if hsk4_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("HSK4", hsk4_1))
            n4_tmp = quy_doi_n4_tu_ccnn("HSK4", hsk4_1)
            if n4_tmp is not None:
                list_n4_quydoi.append(n4_tmp)

        if hsk5_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("HSK5", hsk5_1))
            n4_tmp = quy_doi_n4_tu_ccnn("HSK5", hsk5_1)
            if n4_tmp is not None:
                list_n4_quydoi.append(n4_tmp)

        if hsk6_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("HSK6", hsk6_1))
            n4_tmp = quy_doi_n4_tu_ccnn("HSK6", hsk6_1)
            if n4_tmp is not None:
                list_n4_quydoi.append(n4_tmp)

        if jlpt_n1_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("JLPT_N1", jlpt_n1_1))

        if jlpt_n2_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("JLPT_N2", jlpt_n2_1))

        if jlpt_n3_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("JLPT_N3", jlpt_n3_1))

        if topikii_3_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOPIK II_N3", topikii_3_1))

        if topikii_4_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOPIK II_N4", topikii_4_1))

        if topikii_5_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOPIK II_N5", topikii_5_1))

        if topikii_6_1 > 0:
            list_diem_cong.append(tinh_diem_cong_ccnn("TOPIK II_N6", topikii_6_1))

        diem_cong_ccnn = max(list_diem_cong) if list_diem_cong else 0.0

        n1_quydoi = max(list_n1_quydoi) if list_n1_quydoi else None
        n4_quydoi = max(list_n4_quydoi) if list_n4_quydoi else None

        tohop_list = list(cau_hinh_xt[ma_nganh].keys())
        best = {"diem": -1, "tohop": None, "chi_tiet": None}

        for tohop in tohop_list:
            diem_tohop, chi_tiet = tinh_diem_to_hop(mon_goc, ma_nganh, tohop)
            if diem_tohop is None:
                continue
            if diem_tohop > best["diem"]:
                best = {"diem": diem_tohop, "tohop": tohop, "chi_tiet": chi_tiet}


        if best["tohop"]:
            st.success(f"Tổ hợp cao nhất: {best['tohop']} ({', '.join(cau_hinh_xt[ma_nganh][best['tohop']].keys())})")

            tong_diem_goc = sum(mon_goc.get(mon, 0) for mon in cau_hinh_xt[ma_nganh][best['tohop']].keys())
            st.write(f"🟢 Tổng điểm gốc theo tổ hợp cao nhất (trước quy đổi): {tong_diem_goc}")
            st.write(f"1️⃣ Điểm tổ hợp quy đổi tương đương THPT (không cộng ưu tiên): {best['chi_tiet']['diem_tohop']}")
            st.write(f"3️⃣ Điểm quy đổi Tiếng Anh chứng chỉ ngoại ngữ : {best['chi_tiet']['n1_quydoi'] if best['chi_tiet']['n1_quydoi'] else 'Không'}")
            st.write(f"4️⃣ Điểm cộng chứng chỉ ngoại ngữ: {best['chi_tiet']['diem_cong_ccnn']}")
            st.write(f"5️⃣ Điểm cộng đối tượng và khu vực ưu tiên: {best['chi_tiet']['diem_kv_dt_applied']}")
            st.markdown(f"### 🟢 **TỔNG ĐIỂM XÉT TUYỂN: {best['chi_tiet']['tong_xt']}**")

            with st.expander("Xem chi tiết điểm quy đổi theo từng môn"):
                if best['chi_tiet'] and 'diem_quy_doi_theo_mon' in best['chi_tiet'] and best['chi_tiet']['diem_quy_doi_theo_mon']:
                    df_chi_tiet = pd.DataFrame(
                        list(best['chi_tiet']['diem_quy_doi_theo_mon'].items()), 
                        columns=['Môn','Điểm quy đổi']
                    )
                    st.dataframe(df_chi_tiet)
                else:
                    st.info("Không có dữ liệu điểm quy đổi theo môn để hiển thị.")
        else:
            st.error("Không có tổ hợp nào đạt điều kiện (không đủ điểm sàn hoặc thiếu dữ liệu để quy đổi).")

with tab3:
    #st.header("Xử lý PTXT 3")
    data_DGNL = [
        {"a": 958, "b": 1122, "c": 27, "d": 30},
        {"a": 932, "b": 958, "c": 26, "d": 27},
        {"a": 886, "b": 932, "c": 24.5, "d": 26.0},
        {"a": 815, "b": 886, "c": 22.35, "d": 24.5},
        {"a": 755, "b": 815, "c": 20.5, "d": 22.35},
        {"a": 701, "b": 755, "c": 19, "d": 20.5},
        {"a": 652, "b": 701, "c": 17.6, "d": 19},
        {"a": 605, "b": 652, "c": 16.25, "d": 17.6},
        {"a": 560, "b": 605, "c": 14.8, "d": 16.25},
        {"a": 514, "b": 560, "c": 13.2, "d": 14.8},
        {"a": 458, "b": 514, "c": 11.15, "d": 13.2},
        {"a": 0, "b": 458, "c": 0, "d": 11.15},
    ]

    def quy_doi(x):
        for row in data_DGNL:
            a, b, c, d = row["a"], row["b"], row["c"], row["d"]
            if a < x <= b:
                y = c + ((x - a) / (b - a)) * (d - c)
                return round(y, 2)
        return 0


    def tinh_diem_cong_ccnn(loai_ccnn, diem):
        if loai_ccnn == "IELTS Academic":
            if diem >= 8.5:
                return 2.0
            elif diem >= 8.0:
                return 1.5
            elif 7.0 <= diem <= 7.5:
                return 1.0
            elif 6.0 <= diem <= 6.5:
                return 0.5
        elif loai_ccnn == "TOEFL iBT":
            if diem >= 79:
                return 2.0
            elif 60 <= diem <= 78:
                return 1.5
            elif 46 <= diem <= 59:
                return 1.0
        elif loai_ccnn == "TOEFL ITP":
            if diem >= 547:
                return 2.0
            elif 520 <= diem <= 546:
                return 1.5
            elif 513 <= diem <= 517:
                return 1.0
            elif 490 <= diem <= 510:
                return 0.5
        elif loai_ccnn == "HSK3":
            if diem >= 180:
                return 0.5
        elif loai_ccnn == "HSK4":
            if diem >= 180:
                return 1
        elif loai_ccnn == "HSK5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "HSK6":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N1":
            if diem >= 1:
                return 2
        elif loai_ccnn == "JLPT_N2":
            if diem >= 150:
                return 1.5
        elif loai_ccnn == "JLPT_N2":
            if diem >= 90:
                return 1
        elif loai_ccnn == "JLPT_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N3":
            if diem >= 1:
                return 0.5
        elif loai_ccnn == "TOPIK II_N4":
            if diem >= 1:
                return 1
        elif loai_ccnn == "TOPIK II_N5":
            if diem >= 1:
                return 1.5
        elif loai_ccnn == "TOPIK II_N6":
            if diem >= 1:
                return 2
        return 0.0

    st.markdown(
    "<h1 style='text-align: center; color: #003366;'>KẾT QUẢ KỲ THI ĐGNL ĐHQG TP. HỒ CHÍ MINH</h1>",
    unsafe_allow_html=True
    )

    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        ĐIỂM ĐÁNH GIÁ NĂNG LỰC ĐHQG TP.HCM
    </div>
    """,
    unsafe_allow_html=True
    )

    # Nhập điểm ĐGNL
    diem_dgnl = st.number_input("Nhập điểm ĐGNL (0 - 1200):", min_value=0, max_value=1200, value=0)

    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        ĐỐI TƯỢNG VÀ KHU VỰC ƯU TIÊN
    </div>
    """,
    unsafe_allow_html=True
    )


    khu_vuc = st.selectbox("Khu vực ưu tiên", ["Không", "KV1", "KV2NT", "KV2", "KV3"])

    doi_tuong = st.selectbox("Đối tượng ưu tiên", ["Không", "ĐT01", "ĐT02", "ĐT03", "ĐT04", "ĐT05", "ĐT06", "ĐT07"])


    st.markdown(
    """
    <div style="
        background-color:#003366;
        padding: 15px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: white;
    ">
        CHỨNG CHỈ QUỐC TẾ
    </div>
    """,
    unsafe_allow_html=True
    )


    ielts = st.number_input("IELTS Academic", min_value=0.0, max_value=9.0, step=0.5, format="%.1f", value=0.0, key="ielts")
    toefl_ibt = st.number_input("TOEFL iBT", min_value=0, max_value=150, step=1, value=0, key="toefl_ibt")
    toefl_itp = st.number_input("TOEFL ITP", min_value=0, max_value=100, step=1, value=0, key="toefl_itp")
    hsk3 = st.number_input("HSK3", min_value=0, max_value=300, step=1, value=0, key="hsk3")
    hsk4 = st.number_input("HSK4", min_value=0, max_value=300, step=1, value=0, key="hsk4")
    hsk5 = st.number_input("HSK5", min_value=0, max_value=300, step=1, value=0, key="hsk5")
    hsk6 = st.number_input("HSK6", min_value=0, max_value=300, step=1, value=0, key="hsk6")
    jlpt_n1 = st.number_input("JLPT_N1", min_value=0, max_value=300, step=1, value=0, key="jlpt_n1")
    jlpt_n2 = st.number_input("JLPT_N2", min_value=0, max_value=300, step=1, value=0, key="jlpt_n2")
    jlpt_n3 = st.number_input("JLPT_N3", min_value=0, max_value=300, step=1, value=0, key="jlpt_n3")
    topikii_3 = st.number_input("TOPIK II_N3", min_value=0, max_value=300, step=1, value=0, key="topikii_3")
    topikii_4 = st.number_input("TOPIK II_N4", min_value=0, max_value=300, step=1, value=0, key="topikii_4")
    topikii_5 = st.number_input("TOPIK II_N5", min_value=0, max_value=300, step=1, value=0, key="topikii_5")
    topikii_6 = st.number_input("TOPIK II_N6", min_value=0, max_value=300, step=1, value=0, key="topikii_6")





    # CSS cho nút
    st.markdown("""
        <style>
        /* Canh giữa toàn bộ container của nút */
        div[data-testid="stHorizontalBlock"] div.stButton {
            display: flex;
            justify-content: center;
        }

        /* Style cho nút */
        div.stButton > button {
            background-color: #003366; /* Xanh đậm */
            color: white;
            font-weight: bold;
            border-radius: 8px;
            padding: 10px 20px;
            border: none;
        }

        /* Khi rê chuột */
        div.stButton > button:hover {
            background-color: #0055aa; /* Xanh sáng hơn khi hover */
            color: white;
        }
        </style>
    """, unsafe_allow_html=True)

    # Nút bấm
    if st.button("TÍNH ĐIỂM XÉT TUYỂN", key="btn_tinh_dgnl"):



    # Tính điểm ưu tiên đối tượng
        if doi_tuong in ["ĐT01", "ĐT02", "ĐT03", "ĐT04"]:
            diem_uu_tien_dt = 2.0
        elif doi_tuong in ["ĐT05", "ĐT06", "ĐT07"]:
            diem_uu_tien_dt = 1.0
        else:
            diem_uu_tien_dt = 0.0

    diem_uu_tien_kv = {"Không": 0.0, "KV1": 0.75, "KV2NT": 0.5, "KV2": 0.25, "KV3": 0.0}[khu_vuc]

    diem_kv_dt = diem_uu_tien_kv + diem_uu_tien_dt

    diem_cong_ielts = tinh_diem_cong_ccnn("IELTS Academic", ielts)
    diem_cong_toefl_ibt = tinh_diem_cong_ccnn("TOEFL iBT", toefl_ibt)
    diem_cong_toefl_itp = tinh_diem_cong_ccnn("TOEFL ITP", toefl_itp)
    diem_cong_hsk3 = tinh_diem_cong_ccnn("HSK3", hsk3)
    diem_cong_hsk4 = tinh_diem_cong_ccnn("HSK4", hsk4)
    diem_cong_hsk5 = tinh_diem_cong_ccnn("HSK5", hsk5)
    diem_cong_hsk6 = tinh_diem_cong_ccnn("HSK6", hsk6)
    diem_cong_jlpt_n1 = tinh_diem_cong_ccnn("JLPT_N1", jlpt_n1)
    diem_cong_jlpt_n2 = tinh_diem_cong_ccnn("JLPT_N2", jlpt_n2)
    diem_cong_jlpt_n3 = tinh_diem_cong_ccnn("JLPT_N3", jlpt_n3)
    diem_cong_topikii_3 = tinh_diem_cong_ccnn("TOPIK II_N3", topikii_3)
    diem_cong_topikii_4 = tinh_diem_cong_ccnn("TOPIK II_N4", topikii_4)
    diem_cong_topikii_5 = tinh_diem_cong_ccnn("TOPIK II_N5", topikii_5)
    diem_cong_topikii_6 = tinh_diem_cong_ccnn("TOPIK II_N6", topikii_6)


    diem_cong_ccnn = max(diem_cong_ielts, diem_cong_toefl_ibt, diem_cong_toefl_itp, diem_cong_hsk3, diem_cong_hsk4, diem_cong_hsk5, diem_cong_hsk6, diem_cong_jlpt_n1, diem_cong_jlpt_n2, diem_cong_jlpt_n3, 
                        diem_cong_topikii_3, diem_cong_topikii_4, diem_cong_topikii_5, diem_cong_topikii_6)

    # Quy đổi điểm ĐGNL
    diem_quy_doi = quy_doi(diem_dgnl)

    tong_diem_goc = diem_dgnl
    tong_diem_xt = diem_quy_doi + diem_cong_ccnn

    if tong_diem_xt >= 22.5:
        diem_kvut_moi = ((30 - tong_diem_xt) / 7.5) * diem_kv_dt
    else:
        diem_kvut_moi = diem_kv_dt
    tong_diem_xt += diem_kvut_moi

    # Hiển thị kết quả
    st.subheader("KẾT QUẢ ĐIỂM XÉT TUYỂN")
    st.markdown(f"**Điểm thi Đánh giá năng lực ĐHQG TP.HCM (trước quy đổi):** {tong_diem_goc}")
    st.markdown(f"**Điểm quy đổi tương đương THPT:** {diem_quy_doi}")
    st.markdown(f"**Điểm cộng chứng chỉ ngoại ngữ:** {diem_cong_ccnn}")
    st.markdown(f"**Điểm cộng đối tượng và khu vực ưu tiên:** {diem_kvut_moi}")
    st.markdown(f"### 🟢 TỔNG ĐIỂM XÉT TUYỂN: {tong_diem_xt:.2f}")

